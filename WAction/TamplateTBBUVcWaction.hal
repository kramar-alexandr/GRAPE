procedure AddTemplateTBBULineType(Integer t,Boolean firstf)begin  record TemplateTBBUVc TempTBBUr;  row TemplateTBBUVc TempTBBUrw;  Integer wn,rownr;    wn = CurWindow;  GetWindowRecord(wn,TempTBBUr);    rownr = WindowActiveRow(wn);    DeselectWindow(wn,false);    if (rownr<0) then begin       if (firstf) then begin        rownr = 0;      end else begin        rownr = MatRowCnt(TempTBBUr);      end;    end;    ClearRow(TempTBBUr,TempTBBUrw,t);    TempTBBUrw.Spec = "";    MatRowInsert(TempTBBUr,rownr,TempTBBUrw);    PutWindowRecord(wn,TempTBBUr);    WindowFieldGoto(wn,TempTBBUr,rownr,"Spec",false);  return;end;globalprocedure HeaderLineTemplateTBBUDsm()BEGIN  AddTemplateTBBULineType(17,true);  RETURN;END;globalprocedure SubtotalTemplateTBBUDsm()BEGIN  record TemplateTBBUVc TempTBBUr;  row TemplateTBBUVc TempTBBUrw;  Integer wn,i,rwcnt,rownr;  wn = CurWindow;  if (WindowState(wn)==Rs_normal) then begin    DoUpdate(wn);  end;  if (WindowState(wn)!=Rs_update) then begin    goto LOutSubtotalTBBUDsm;  end;  GetWindowRecord(wn,TempTBBUr);  rwcnt = MatRowCnt(TempTBBUr);  rownr = WindowActiveRow(wn);  if ((rownr==-1) or (rownr>rwcnt)) then begin    rownr = rwcnt;  end;  DeselectWindow(wn,false);   ClearRow(TempTBBUr,TempTBBUrw,9);  MatRowInsert(TempTBBUr,rownr,TempTBBUrw);  PutWindowRecord(wn,TempTBBUr);LOutSubtotalTBBUDsm:;    RETURN;END;